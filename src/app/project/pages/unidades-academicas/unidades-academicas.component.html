<p-toast [key]="keyPopups"></p-toast>
<p-confirmDialog [key]="keyPopups" [style]="{ width: '500px' }"></p-confirmDialog>
 
<div class="grid">
    <div class="col-12">
        <app-card header="Mantenedor de unidades académicas" subheader="Permite ver, crear, actualizar y eliminar unidades académicas.">
            <app-menu-buttons-table></app-menu-buttons-table>
 
            <app-table-unidades-academicas [data]="unidadesAcademicas" [cols]="cols" [globalFiltros]="globalFiltros" [dataKeyTable]="dataKeyTable"></app-table-unidades-academicas>
 
            <app-dialog [(visible)]="dialog">
                <div header>
                    <ng-container [ngSwitch]="mode">
                        <ng-container *ngSwitchCase="'create'"><span class="text-xl">Agregar unidad académica</span></ng-container>
                        <ng-container *ngSwitchCase="'edit'"><span class="text-xl">Actualizar unidad académica</span></ng-container>
                        <ng-container *ngSwitchCase="'show'"><span class="text-xl">Ver unidad académica</span></ng-container>
                    </ng-container>
                </div>
                <div content>  
                    <div class="grid" *ngIf="mode != 'show'">
                        <div class="col-12">
                            <app-form-isvalid [valid]="fbForm.valid"></app-form-isvalid>
                        </div>
                    </div>
                    <form [formGroup]="fbForm">
                        <div class="grid p-fluid">
                            <div class="col-12 lg:col-6">
                                <div class="field">
                                    <label><strong>Nombre *</strong></label>
                                    <input type="text" pInputText formControlName="Descripcion_ua" maxlength="30"
                                        class="w-full"  placeholder="Ingrese nombre de unidad académica" autofocus />
 
                                    <app-form-control [control]="fbForm.controls['Descripcion_ua']"
                                        [validators]="['required']"></app-form-control>
                                </div>
                            </div>
                            <div class="col-12 lg:col-6">
                                <div class="field">
                                    <label><strong>Facultad</strong></label>
                                    <div *ngIf="mode=='create'">
                                        <p-dropdown [options]="facultades" optionLabel="Descripcion_facu" formControlName="Cod_facultad"
                                        class="w-full"  placeholder="Seleccione una facultad" autofocus>
                                        </p-dropdown>
                                        <app-form-control [control]="fbForm.controls['Cod_facultad']"
                                            [validators]="['required']"></app-form-control>
                                    </div>
                                    <div *ngIf="mode=='edit'">
                                        <p-dropdown [options]="facultades"
                                        optionLabel="Descripcion_facu"
                                        optionValue="Cod_facultad"
                                        formControlName="Cod_facultad"
                                        class="w-full"
                                        autofocus>
                                        </p-dropdown>
                                        <app-form-control [control]="fbForm.controls['Cod_facultad']"
                                            [validators]="['required']"></app-form-control>
                                    </div>
                                    <div *ngIf="mode=='show'">
                                        <input [readOnly]="true" type="text" pInputText formControlName="Cod_facultad">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                    <div class="grid">
                        <div class="col-12 ">
                            <app-uploader-files [mode]="mode"></app-uploader-files>
                        </div>
                    </div>
                </div>
                <div footer>
                    <p-button label="Cerrar" icon="pi pi-times" styleClass="p-button-sm p-button-secondary mr-2" (click)="dialog = false" [text]="true"></p-button>
 
                    <p-button *ngIf="mode == 'create' || mode == 'edit' "
                        [label]="mode === 'edit' ? 'Actualizar' : 'Guardar'" icon="pi pi-check"
                        styleClass="mr-2 p-button-success p-button-sm" [disabled]="!fbForm.valid"
                        (click)="fbForm.valid && submit()">
                    </p-button>
                </div>
            </app-dialog>
        </app-card>
 
    </div>
</div>